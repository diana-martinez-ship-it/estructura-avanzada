<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Semana 7 — Actividades de IA (Programación del lado del servidor)</title>
  <style>
    :root{
      --bg:#f7fafc; --ink:#0f172a; --sub:#475569; --card:#ffffff;
      --pri:#2563eb; --sec:#7c3aed; --ok:#16a34a; --warn:#f59e0b; --err:#ef4444;
      --pastel1:#e0e7ff; --pastel2:#fde68a33; --pastel3:#f5d0fe55; --pastel4:#bbf7d0;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;line-height:1.65;background:var(--bg);color:var(--ink)}
    .wrap{max-width:1100px;margin:0 auto;padding:28px}
    header{background:linear-gradient(135deg,var(--pri),var(--sec));color:#fff;padding:22px;border-radius:18px}
    h1{margin:0 0 6px}
    .note{color:#e5e7eb;opacity:.95}
    h2{margin-top:28px;border-left:6px solid var(--pri);padding-left:12px}
    .card{background:var(--card);border-radius:16px;box-shadow:0 8px 28px rgba(2,6,23,.08);padding:18px;margin:16px 0}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
    .tag{display:inline-block;background:var(--pastel1);color:#1e3a8a;padding:4px 10px;border-radius:999px;font-weight:600;margin:2px 6px 0 0}
    pre{background:#0b1220;color:#e5e7eb;padding:16px;border-radius:14px;overflow:auto}
    code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    .rubric td,.rubric th{border:1px solid #e2e8f0;padding:10px}
    table{width:100%;border-collapse:collapse}
    .warn{border-left:6px solid var(--warn);background:#fffbeb}
    .ok{border-left:6px solid var(--ok);background:#f0fdf4}
    .pill{display:inline-block;background:#eef2ff;color:#4338ca;border:1px dashed #c7d2fe;padding:6px 8px;border-radius:10px;margin-right:8px}
    .kicker{font-weight:700;letter-spacing:.06em;text-transform:uppercase;color:#334155}
    .num{display:inline-grid;place-items:center;width:30px;height:30px;border-radius:50%;background:var(--pri);color:#fff;font-weight:700;margin-right:10px}
    .flex{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
    footer{margin-top:32px;color:var(--sub);font-size:.95rem}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Semana 7 — Actividades de IA</h1>
      <p class="note">Programación del lado del servidor · Rutas, controladores, middleware, validación, autenticación, pruebas y observabilidad.</p>
    </header>

    <div class="card warn">
      <div class="kicker">Instrucciones generales</div>
      <ul>
        <li>Ejecuta cada prompt en una IA generativa y <strong>añade tu crítica técnica</strong> + una <strong>iteración mejorada</strong> del prompt.</li>
        <li>Entrega un PDF con evidencia: <em>prompt → respuesta → análisis → código/pruebas/diagramas</em>.</li>
        <li>Usa un framework a elección (Express/FastAPI/Laravel/.NET Minimal APIs), pero mantén la solución <strong>agnóstica</strong> a tecnología.</li>
      </ul>
    </div>

    <h2>Resultados de aprendizaje (mapa a Semana 7)</h2>
    <div class="card">
      <ul>
        <li>Construye <strong>rutas y controladores</strong> con <strong>validación/serialización</strong> (DTO/JSON Schema).</li>
        <li>Implementa <strong>middleware de autenticación</strong> (JWT/cookies) y <strong>rate limiting</strong>.</li>
        <li>Instrumenta <strong>logs y métricas</strong> de la API (observabilidad mínima).</li>
        <li>Diseña <strong>pruebas de integración E2E</strong> con fixtures y casos de borde.</li>
      </ul>
    </div>

    <h2>Actividades IA (copiar/pegar)</h2>

    <div class="card">
      <div class="flex"><span class="num">1</span><strong>Esqueleto de API + contratos</strong> <span class="tag">CRUD</span> <span class="tag">DTO</span> <span class="tag">OpenAPI</span></div>
      <p><em>Objetivo:</em> obtener un diseño consistente de rutas, controladores y contratos de datos.</p>
<pre><code>Actúa como arquitecto/a de APIs REST.
Contexto: Semana 7 (servidor). Necesito un CRUD de /products con versión en ruta (/api/v1).
Requisitos:
- Validación robusta en entrada (JSON Schema) y serialización de salida (sin nulls).
- Manejo de errores uniforme: { data:null, error:{code,msg,details}, meta:{} }.
- Seguridad básica: límite tamaño de payload y sanitización XSS/SQLi sin libs propietarias.
- Documentación: OpenAPI 3.0 mínima (paths, schemas).

Entregables:
1) Árbol de rutas y controladores.
2) DTO de request/response con ejemplos válidos/ inválidos.
3) Esqueleto de código en el framework elegido (o pseudocódigo).
4) OpenAPI YAML mínima.
5) Casos de borde (ID inexistente, body vacío, tipos erróneos).</code></pre>
    </div>

    <div class="card">
      <div class="flex"><span class="num">2</span><strong>Middleware de autenticación + rate limiting</strong> <span class="tag">JWT</span> <span class="tag">RBAC</span> <span class="tag">429</span></div>
      <p><em>Objetivo:</em> proteger endpoints y prevenir abuso.</p>
<pre><code>Eres especialista en seguridad backend.
Diseña middleware para:
- Auth Bearer JWT (HS256), expira 15 min; refresh token por cookie httpOnly (SameSite=Lax).
- Rate limit: 100 req/15m por IP y 1000 req/15m por userId.
- Roles: admin, user; /api/v1/admin/* solo para admin.
- Logs estructurados (correlationId) + métricas (p50/p95, 4xx/5xx por endpoint).

Entrega:
A) Diagrama del pipeline (texto ASCII).
B) Código de ejemplo.
C) Tabla de respuestas 401/403/429 con cuerpo JSON.
D) 3 pruebas exitosas y 3 fallidas (curl o framework).</code></pre>
    </div>

    <div class="card">
      <div class="flex"><span class="num">3</span><strong>Validación y serialización deterministas</strong> <span class="tag">JSON Schema</span> <span class="tag">DTO</span></div>
      <p><em>Objetivo:</em> contratos confiables y respuestas estables.</p>
<pre><code>Actúa como especialista en datos.
Define esquemas para Product { id, name, price, currency, tags[], createdAt } con reglas:
- price &gt;= 0; currency ∈ {MXN,USD,EUR}; name 2..80 chars; tags 0..10; createdAt ISO-8601.
- Salida: sin claves nulas y con orden de propiedades consistente.

Entrega:
1) JSON Schema y ejemplos.
2) Validadores (pseudocódigo).
3) Tabla de errores por regla (código y mensaje).
4) Fuzzing: 10 entradas problemáticas y el resultado esperado.</code></pre>
    </div>

    <div class="card">
      <div class="flex"><span class="num">4</span><strong>Pruebas de integración E2E</strong> <span class="tag">Testing</span> <span class="tag">Fixtures</span></div>
      <p><em>Objetivo:</em> asegurar calidad de extremo a extremo.</p>
<pre><code>Asume /api/v1/products.
Genera:
- Escenarios E2E (crear → consultar → actualizar → borrar) con fixtures.
- Matriz de casos: éxito, validación, concurrencia (409) y errores 4xx/5xx.
- Scripts de tests (curl o framework) y limpieza transaccional.
- Indicadores: cobertura de endpoints y latencia media.</code></pre>
    </div>

    <div class="card">
      <div class="flex"><span class="num">5</span><strong>Observabilidad mínima viable</strong> <span class="tag">Logging</span> <span class="tag">Metrics</span></div>
      <p><em>Objetivo:</em> instrumentar desde el día 1.</p>
<pre><code>Eres SRE.
Propón:
- Estructura de log JSON {ts, level, correlationId, path, method, status, latency_ms, userId?}.
- Métricas por endpoint (p50/p95, error_rate_4xx_5xx).
- Trazas textuales del pipeline request→respuesta.
- Dashboard: 5 gráficos imprescindibles y 3 alertas con umbral.</code></pre>
    </div>

    <h2>Plantillas rápidas</h2>
    <div class="grid">
      <div class="card">
        <span class="pill">OpenAPI mínima</span>
<pre><code>openapi: 3.0.0
info: { title: API Productos, version: 1.0.0 }
paths:
  /api/v1/products:
    get: { summary: Listar }
    post: { summary: Crear }
  /api/v1/products/{id}:
    get: { summary: Detalle }
    put: { summary: Actualizar }
    delete: { summary: Eliminar }
components:
  schemas:
    Product:
      type: object
      required: [id, name, price, currency, createdAt]
      properties:
        id: { type: string, format: uuid }
        name: { type: string, minLength: 2, maxLength: 80 }
        price: { type: number, minimum: 0 }
        currency: { type: string, enum: [MXN, USD, EUR] }
        tags: { type: array, items: { type: string }, maxItems: 10 }
        createdAt: { type: string, format: date-time }</code></pre>
      </div>
      <div class="card">
        <span class="pill">Tabla de errores estándar</span>
        <table class="rubric">
          <thead><tr><th>Código</th><th>Motivo</th><th>Cuerpo JSON</th></tr></thead>
          <tbody>
            <tr><td>400</td><td>Entrada inválida</td><td><code>{ "error": { "code":"BAD_REQUEST","details":[...] } }</code></td></tr>
            <tr><td>401</td><td>No autenticado</td><td><code>{ "error": { "code":"UNAUTHENTICATED" } }</code></td></tr>
            <tr><td>403</td><td>Sin permiso</td><td><code>{ "error": { "code":"FORBIDDEN" } }</code></td></tr>
            <tr><td>404</td><td>No encontrado</td><td><code>{ "error": { "code":"NOT_FOUND" } }</code></td></tr>
            <tr><td>409</td><td>Conflicto</td><td><code>{ "error": { "code":"CONFLICT" } }</code></td></tr>
            <tr><td>429</td><td>Límite excedido</td><td><code>{ "error": { "code":"RATE_LIMITED" } }</code></td></tr>
            <tr><td>500</td><td>Error interno</td><td><code>{ "error": { "code":"INTERNAL" } }</code></td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <h2>Rúbrica (por ejercicio)</h2>
    <div class="card ok">
      <table class="rubric">
        <thead>
          <tr><th>Criterio</th><th>Excelente (2)</th><th>Aceptable (1)</th><th>Insuficiente (0)</th></tr>
        </thead>
        <tbody>
          <tr><td>Claridad del prompt</td><td>Contexto y entregables completos</td><td>Lagunas menores</td><td>Vago</td></tr>
          <tr><td>Corrección técnica</td><td>Buenas prácticas (seguridad/contratos)</td><td>Detalles menores faltantes</td><td>Errores</td></tr>
          <tr><td>Evidencia</td><td>Pruebas/fixtures y métricas</td><td>Pruebas básicas</td><td>Sin pruebas</td></tr>
          <tr><td>Iteración</td><td>Versión mejorada + reflexión</td><td>Iteración parcial</td><td>Sin iteración</td></tr>
        </tbody>
      </table>
      <p class="note">Puntaje por ejercicio: 0–8. Total sugerido: 5 ejercicios = 40 pts.</p>
    </div>

    <h2>Formato de entrega</h2>
    <div class="card">
      <ol>
        <li>Prompt inicial.</li>
        <li>Respuesta de IA (capturas o texto).</li>
        <li>Crítica técnica + versión mejorada del prompt.</li>
        <li>Evidencia (código/pruebas/diagramas/metrics).</li>
      </ol>
      <p class="note">Indica framework y versión; adjunta instrucciones para reproducir.</p>
    </div>

    <footer>Semana 7 — Actividades IA | v1.1 | Programación del Lado del Servidor</footer>
  </div>
</body>
</html>
